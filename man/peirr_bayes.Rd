% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/peirr_bayes.R
\name{peirr_bayes}
\alias{peirr_bayes}
\title{Bayesian inference for simple stochastic epidemic with partial data}
\usage{
peirr_bayes(
  removals,
  infections,
  population_size,
  beta_init = 1,
  gamma_init = 1,
  beta_shape = 1,
  gamma_shape = 1,
  num_iter = 500,
  num_update = 10,
  num_tries = 5,
  num_print = 100,
  update_gamma = FALSE,
  num_renewals = 1,
  lag = 0
)
}
\arguments{
\item{removals}{A numeric vector of removal/recovery times. NA values indicate unobserved times.}

\item{infections}{A numeric vector of infection times. NA values indicate unobserved times.}

\item{population_size}{An integer specifying the total population size.}

\item{beta_init}{A numeric initial estimate for the beta (infection rate) parameter.}

\item{gamma_init}{A numeric initial estimate for the gamma (removal rate) parameter.}

\item{beta_shape}{A numeric shape parameter for the gamma prior on beta.}

\item{gamma_shape}{A numeric shape parameter for the gamma prior on gamma.}

\item{num_iter}{An integer specifying the total number of MCMC iterations.}

\item{num_update}{An integer specifying the number of Metropolis-Hastings updates
for infection and removal times per iteration.}

\item{num_tries}{An integer specifying the total number of draws
to check if proposal is consistent with an epidemic.}

\item{num_print}{An integer specifying the print frequency for iteration progress.}

\item{update_gamma}{bool: TRUE to update removal rate estimate from initial estimate}

\item{num_renewals}{A numeric shape parameter for the gamma distribution used in data augmentation.}

\item{lag}{numeric: fixed incubation period}
}
\value{
A list with the following elements:
\itemize{
\item \code{infection_rate}: vector of posterior samples for beta (infection rate)
\item \code{removal_rate}: vector of posterior samples for gamma (removal rate)
\item \code{prop_infection_updated}: vector of proportion of infection times accepted per iteration
\item \code{prop_removal_updated}: vector of proportion of removal times accepted per iteration
}
}
\description{
Sample posterior of global infection and removal rates with partial data.
}
\details{
The function implements a data augmentation MCMC algorithm for epidemic models.
It alternates between:
(1) updating gamma via Gibbs sampling,
(2) updating missing infection times via Metropolis-Hastings,
(3) updating missing removal times via Metropolis-Hastings, and
(4) updating beta via Gibbs sampling.
All epidemic configurations are validated
to ensure consistency with epidemic dynamics.
}
\examples{
# Bayesian inference with missing data
set.seed(2)
epi2 <- simulator(beta = 1.5, gamma = 0.8, population_size = 80,
                  prop_complete = 0.7, prop_infection_missing = 0.6)

fit2 <- peirr_bayes(
  removals = epi2$matrix_time[, "removal"],
  infections = epi2$matrix_time[, "infection"],
  population_size = 80,
  beta_init = 1.0,
  gamma_init = 0.8,
  beta_shape = 0.1,
  gamma_shape = 0.1,
  num_iter = 200,
  num_update = 10,
  num_tries = 5,
  num_print = 100,
  update_gamma = FALSE,
  lag = 0
)

# Check data augmentation efficiency
mean(fit2$prop_infection_updated, na.rm = TRUE)  # Mean acceptance rates
mean(fit2$prop_removal_updated, na.rm = TRUE)

}
