% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/peirr_bayes_spatial.R
\name{peirr_bayes_spatial}
\alias{peirr_bayes_spatial}
\title{Bayesian inference for spatial epidemic with partial data}
\usage{
peirr_bayes_spatial(
  removals,
  infections,
  population_size,
  kernel_spatial,
  matrix_distance,
  beta_init = 1,
  gamma_init = 1,
  beta_shape = 1,
  gamma_shape = 1,
  num_update = 10,
  num_iter = 500,
  num_print = 100,
  num_tries = 5,
  update_gamma = FALSE,
  num_renewals = 1,
  lag = 0
)
}
\arguments{
\item{removals}{A numeric vector of removal/recovery times. NA values indicate unobserved times.}

\item{infections}{A numeric vector of infection times. NA values indicate unobserved times.}

\item{population_size}{An integer specifying the total population size.}

\item{kernel_spatial}{function: symmetric function of distance}

\item{matrix_distance}{numeric: two-dimensional distance matrix}

\item{beta_init}{A numeric initial estimate for the beta (transmission rate) parameter.}

\item{gamma_init}{A numeric initial estimate for the gamma (recovery rate) parameter.}

\item{beta_shape}{A numeric shape parameter for the gamma prior on beta.}

\item{gamma_shape}{A numeric shape parameter for the gamma prior on gamma.}

\item{num_update}{An integer specifying the number of Metropolis-Hastings updates
for infection and removal times per iteration.}

\item{num_iter}{An integer specifying the total number of MCMC iterations.}

\item{num_print}{An integer specifying the print frequency for iteration progress.}

\item{num_tries}{An integer specifying the total number of draws
to check if proposal is consistent with an epidemic.}

\item{update_gamma}{bool: TRUE to update removal rate estimate from initial estimate}

\item{num_renewals}{A numeric shape parameter for the gamma distribution used in data augmentation.}

\item{lag}{numeric: fixed incubation period}
}
\value{
A list with the following elements:
\itemize{
\item \code{infection_rate}: vector of posterior samples for beta (infection rate)
\item \code{removal_rate}: vector of posterior samples for gamma (removal rate)
\item \code{prop_infection_updated}: proportion of infection times accepted per iteration
\item \code{prop_removal_updated}: proportion of removal times accepted per iteration
}
}
\description{
Sample posterior of infection and removal rates with spatial effect.
}
\details{
The function implements a data augmentation MCMC algorithm for epidemic models.
It alternates between:
(1) updating gamma via Gibbs sampling,
(2) updating missing infection times via Metropolis-Hastings,
(3) updating missing removal times via Metropolis-Hastings, and
(4) updating beta via Gibbs sampling.
All epidemic configurations are validated
to ensure consistency with epidemic dynamics.
}
