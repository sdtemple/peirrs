% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/simulator_spatial.R
\name{simulator_spatial}
\alias{simulator_spatial}
\title{Simulate spatial stochastic epidemic model with post-processing}
\usage{
simulator_spatial(
  beta,
  gamma,
  population_size,
  kernel_spatial,
  matrix_distance,
  num_renewals = 1,
  lag = 0,
  prop_complete = 0.5,
  prop_infection_missing = 1,
  min_epidemic_size = 10,
  max_epidemic_size = Inf
)
}
\arguments{
\item{beta}{numeric: infection rate}

\item{gamma}{numeric: removal rate}

\item{population_size}{integer: population size}

\item{kernel_spatial}{function: symmetric function of distance}

\item{matrix_distance}{numeric: two-dimensional distance matrix}

\item{num_renewals}{integer: positive shape}

\item{lag}{numeric: fixed incubation period}

\item{prop_complete}{numeric: expected proportion of complete pairs observed}

\item{prop_infection_missing}{numeric: expected proportion of missing infection times}

\item{min_epidemic_size}{integer: epidemic is at least this large}

\item{max_epidemic_size}{integer: epidemic is no larger than this}
}
\value{
numeric list: matrix of (infection times, removal times), matrix of (St, It, Et, Rt, Time), matrix of n by N distances
}
\description{
Draw infectious periods for spatial stochastic epidemic.
}
\details{
The function repeatedly simulates spatial epidemics until the observed epidemic
size is between \code{min_epidemic_size} and \code{max_epidemic_size} and there is enough
complete infection/removal information to estimate the removal rate.

After simulation, the output is post-processed by:
\itemize{
\item removing non-infected individuals,
\item subsetting the distance matrix to the retained individuals,
\item inserting missingness, and
\item sorting by removal time (with matching distance-matrix reordering).
}

\code{prop_complete} controls the expected fraction of complete infection-removal pairs.
If a pair is made incomplete, \code{prop_infection_missing} is the probability that the
infection time (rather than the removal time) is set to \code{NA}.
}
\examples{
# Build a simple distance matrix
set.seed(1)
n <- 80
coords <- cbind(runif(n), runif(n))
D <- as.matrix(dist(coords))

# Exponential spatial kernel
kernel_spatial <- function(d) exp(-2 * d)

# Basic complete-data spatial simulation
epi1 <- simulator_spatial(beta = 2, gamma = 1,
                          population_size = n,
                          kernel_spatial = kernel_spatial,
                          matrix_distance = D,
                          prop_complete = 1)
dim(epi1$matrix_time)
dim(epi1$matrix_distance)

# Spatial simulation with missingness and lag
set.seed(2)
epi2 <- simulator_spatial(beta = 2, gamma = 1,
                          population_size = n,
                          kernel_spatial = kernel_spatial,
                          matrix_distance = D,
                          lag = 1,
                          prop_complete = 0.7,
                          prop_infection_missing = 0.4)
colSums(is.na(epi2$matrix_time))

}
