% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/peirr_bayes_mutlitype.R
\name{peirr_bayes_multitype}
\alias{peirr_bayes_multitype}
\title{Bayesian Inference for Epidemic Parameters using MCMC}
\usage{
peirr_bayes_multitype(
  removals,
  infections,
  removal_classes,
  infection_classes,
  infection_class_sizes,
  beta_init,
  gamma_init,
  beta_shape,
  gamma_shape,
  num_iter = 500,
  num_update = 10,
  num_tries = 5,
  num_print = 100,
  update_gamma = FALSE,
  num_renewals = 1,
  lag = 0
)
}
\arguments{
\item{removals}{A numeric vector of removal/recovery times. NA values indicate unobserved times.}

\item{infections}{A numeric vector of infection times. NA values indicate unobserved times.}

\item{beta_init}{A numeric initial estimate for the beta (transmission rate) parameter.
Default is 1.}

\item{gamma_init}{A numeric initial estimate for the gamma (recovery rate) parameter.
Default is 1.}

\item{beta_shape}{A numeric shape parameter for the gamma prior on beta. Default is 1.}

\item{gamma_shape}{A numeric shape parameter for the gamma prior on gamma. Default is 1.}

\item{num_iter}{An integer specifying the total number of MCMC iterations. Default is 500.}

\item{num_update}{An integer specifying the number of Metropolis-Hastings updates
for infection and removal times per iteration. Default is 10.}

\item{num_tries}{An integer specifying the total number of draws
to check if proposal is consistent with an epidemic.
Default is 20.}

\item{num_print}{An integer specifying the print frequency for iteration progress.
Default is 100.}

\item{update_gamma}{bool: TRUE to update removal rate estimate from initial estimate
Default is FALSE.}

\item{num_renewals}{A numeric shape parameter for the gamma distribution used in data augmentation.
Default is 1.}

\item{lag}{numeric: fixed exposure period}

\item{population_size}{An integer specifying the total population size.}
}
\value{
A numeric matrix with 2 rows and num_iter columns containing posterior samples.
Row 1 contains samples for beta (transmission rate).
Row 2 contains samples for gamma (recovery rate).
Row 3 contains proportion of infection times augmented/updated.
Row 4 contains proportion of removal times augmented/updated.
}
\description{
Performs Bayesian inference for the transmission rate (beta) and recovery rate (gamma)
parameters of an epidemic model using Markov Chain Monte Carlo (MCMC) sampling.
Implements data augmentation for missing infection and removal times via Metropolis-Hastings
updates, with a Gibbs step for the beta parameter.
}
\details{
The function implements a data augmentation MCMC algorithm for epidemic models.
It alternates between: (1) updating gamma via Gibbs sampling,
(2) updating missing infection times via Metropolis-Hastings,
(3) updating missing removal times via Metropolis-Hastings, and
(4) updating beta via Gibbs sampling. All epidemic configurations are validated
to ensure consistency with epidemic dynamics.
}
