% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/peirr_bayes_multitype.R
\name{peirr_bayes_multitype}
\alias{peirr_bayes_multitype}
\title{Bayesian Inference for Multitype Epidemic Parameters using MCMC}
\usage{
peirr_bayes_multitype(
  r,
  i,
  cr,
  ci,
  Ns,
  binit,
  ginit,
  bshape,
  gshape,
  m = 1,
  num.time.update = 5,
  num.iter = 500,
  num.print = 100,
  num.tries = 20,
  update.gamma = FALSE,
  lag = 0
)
}
\arguments{
\item{r}{A numeric vector of removal/recovery times. NA values indicate unobserved times.}

\item{i}{A numeric vector of infection times. NA values indicate unobserved times.}

\item{cr}{numeric vector: removal time classes}

\item{ci}{numeric vector: infection time classes}

\item{Ns}{integer vector: population sizes for infection classes (sorted)}

\item{binit}{Numeric initial estimates for the beta (transmission rates) parameters.
Default is 1.}

\item{ginit}{Numeric initial estimates for the gamma (recovery rates) parameters.
Default is 1.}

\item{bshape}{Numeric shape parameters for the gamma prior on beta.}

\item{gshape}{Numeric shape parameters for the gamma prior on gamma.}

\item{m}{A numeric shape parameter for the gamma distribution used in data augmentation.
Default is 1.}

\item{num.time.update}{An integer specifying the number of Metropolis-Hastings updates
for infection and removal times per iteration. Default is 10.}

\item{num.iter}{An integer specifying the total number of MCMC iterations. Default is 500.}

\item{num.print}{An integer specifying the print frequency for iteration progress.
Default is 100.}

\item{num.tries}{An integer specifying the total number of draws
to check if proposal is consistent with an epidemic.
Default is 20.}

\item{update.gamma}{bool: TRUE to update removal rate estimates from initial estimate
Default is FALSE.}

\item{lag}{numeric: fixed exposure period}
}
\value{
A numeric matrix with 2 rows and num.iter columns containing posterior samples.
Row 1 contains samples for beta (transmission rate).
Row 2 contains samples for gamma (recovery rate).
Row 3 contains proportion of infection times augmented/updated.
Row 4 contains proportion of removal times augmented/updated.
}
\description{
Performs Bayesian inference for the transmission rate (beta) and recovery rate (gamma)
parameters of an epidemic model using Markov Chain Monte Carlo (MCMC) sampling.
Implements data augmentation for missing infection and removal times via Metropolis-Hastings
updates, with a Gibbs step for the beta parameter.
}
\details{
The function implements a data augmentation MCMC algorithm for epidemic models.
It alternates between: (1) updating gamma via Gibbs sampling,
(2) updating missing infection times via Metropolis-Hastings,
(3) updating missing removal times via Metropolis-Hastings, and
(4) updating beta via Gibbs sampling. All epidemic configurations are validated
to ensure consistency with epidemic dynamics.
}
